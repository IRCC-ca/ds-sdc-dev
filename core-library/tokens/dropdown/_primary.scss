@use '../../util/color' as color;
@use '../../util/theme' as theme;
@use '../template-const' as template-const;
@use '../../component-styling/dropdown/dropdown' as dropdown;
@use '../../util/device' as device;
@use 'sass:map';
@use '../sizes' as sizes;

$primary: 'primary';
$default-color: null;

@mixin tokens($palette, $text-palette) {
    @include theme.select-attribute($palette, color, $default-color) {
        @include theme.light {
            --primary-background-hover: #{color.mix-token($palette, 800)};
            --primary-background: #{color.mix-token($palette, 700)};
            --primary-background-active: #{color.mix-token($palette, 900)};
            --primary-background-disabled: #{color.mix-token($palette, 300)};
            --primary-text: #{color.mix-token($text-palette, 100)};
            --primary-text-disabled: #{color.mix-token($palette, 100)};
        }

        @include theme.dark {
            --primary-background-hover: #{color.mix-token($palette, 500)};
            --primary-background: #{color.mix-token($palette, 600)};
            --primary-background-active: #{color.mix-token($palette, 400)};
            --primary-background-disabled: #{color.mix-token($palette, 1000)};
            --primary-text: #{color.mix-token($text-palette, 200)};
            --primary-text-disabled: #{color.mix-token($text-palette, 1000)};
            --focus-border: #{color.mix-token($palette, 600)};
        }
        --text: var(--primary-text);
    }
}

@mixin create(
    $palette: (
        (role: cta, text: neutral),
        (role: critical, text: neutral),
    )
) {
    @include dropdown.selectors() {
        .primary {
            @each $map in $palette {
                @if not $default-color {
                    $default-color: map.get($map, role) !global;
                }
                @include tokens(map.get($map, role), map.get($map, text));
            }
            @include layout();
        }
    }
}

@mixin layout() {
    @include dropdown.layout();
    .custom-chevron { // to appear chevron on top of background-color at disabled state
        z-index: 10;
	}
    select {
        background-color: var(--primary-background);  
        @include device.if-hover {
            background-color: var(--primary-background-hover);
        }
        &:active {
            background-color: var(--primary-background-active);
        }
        &:disabled {
            background-color: var(--primary-background-disabled);
            --text: var(--primary-text-disabled);
            @include device.if-hover {
                background-color: var(--primary-background-disabled);
            }
        }
    }
}
